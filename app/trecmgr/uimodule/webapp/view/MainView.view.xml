<mvc:View controllerName="ct.trec.cttrecapp.controller.MainView" xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true" xmlns="sap.m">
    <Page id="page" title="{i18n>title}">
        <headerContent>
            <OverflowToolbar>
                <ToolbarSpacer></ToolbarSpacer>
                <Switch state="{view>/settings/use_remote_odata}"></Switch>
            </OverflowToolbar>
        </headerContent>
        <content>
            <Panel id="cmdPanel" expandable="true" expanded="{view>/ui/cmdPanelExpanded}">
                <headerToolbar>
                    <OverflowToolbar>
                        <ToolbarSpacer />
                        <HBox visible="{= !${view>/ui/cmdPanelExpanded}}" alignItems="Center">
                            <Label text="打卡" showColon="true" labelFor="checkInTypeInput"
                                width="2rem" class="sapUiTinyMarginEnd" />
                            <Input id="checkInTypeInput" value="{ckt>/new/text}" width="8rem" />
                            <Button icon="sap-icon://add" press="onNewCheckInType" />
                            <Button icon="sap-icon://save" press="onStoreAllData" />
                            <Button icon="sap-icon://full-screen" press="onOpenMessage" />
                        </HBox>
                    </OverflowToolbar>
                </headerToolbar>
                <content>
                    <OverflowToolbar>
                        <ToolbarSpacer />
                        <Button icon="sap-icon://copy" press="onCopyMessage" />
                        <Button text="Export" press="onExportAllData" />
                        <Button text="Import" press="onImportAllData" />
                        <Button icon="sap-icon://save" press="onStoreAllData" />
                        <Button icon="sap-icon://clear-all" press="onClearAllData" />
                        <Button text="Push" press="onPushAllData"
                            enabled="{view>/settings/use_remote_odata}" />
                        <Button text="Pull" press="onPullAllData"
                            enabled="{view>/settings/use_remote_odata}" />
                    </OverflowToolbar>
                    <TextArea id="msgTextArea" value="{view>/message}" width="100%" height="12rem">
                    </TextArea>
                </content>
            </Panel>
            <FlexBox items="{ckt>/types}" wrap="Wrap" visible="{= !${view>/ui/cmdPanelExpanded}}">
                <Button text="{ckt>text}" press="onTypedCheckIn" class="sapUiSmallMarginBegin" />
            </FlexBox>
            <Panel>
                <content>
                    <Table
                        items="{ path: 'tci>/items',
                            sorter: {
                                path: 'timestamp',
                                descending: true
                            }}"
                        autoPopinMode="true">
                        <columns>
                            <Column width="8rem">
                                <Text text="动作" />
                            </Column>
                            <Column width="10rem" popinDisplay="WithoutHeader">
                                <Text text="时间" />
                            </Column>
                        </columns>
                        <items>
                            <ColumnListItem vAlign="Middle" type="Active" press="onCheckInItemPress">
                                <cells>
                                    <ObjectIdentifier title="{tci>value}"
                                        text="{
                                        path:'tci>comment',
                                        formatter : '.formatEmptyText'
                                    }" />
                                    <DateTimePicker
                                        value="{
                                            path:'tci>timestamp',
                                            type:'sap.ui.model.type.DateTime',
                                            formatOptions: {
                                                'style': 'short'
                                            }
                                        }" />
                                </cells>
                            </ColumnListItem>
                        </items>
                    </Table>
                </content>
            </Panel>
        </content>
        <footer>
            <Bar></Bar>
        </footer>
    </Page>
</mvc:View>