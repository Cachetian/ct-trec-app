<mvc:View
    controllerName="ct.trec.trecmgr.controller.Setting"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m"
>
    <Page title="{i18n>title}">
        <headerContent>
            <OverflowToolbar>
                <ToolbarSpacer />
                <Button
                    icon="sap-icon://home"
                    press="onHomePress"
                />
                <Switch state="{view>/settings/use_remote_odata}" />
            </OverflowToolbar>
        </headerContent>
        <Panel
            expandable="true"
            expanded="{view>/ui/cmdPanelExpanded}"
        >
            <headerToolbar>
                <OverflowToolbar>
                    <HBox
                        alignItems="Center"
                        visible="{= !${view>/ui/cmdPanelExpanded}}"
                    >
                        <Label
                            text="打卡"
                            showColon="true"
                            labelFor="checkInTypeInput"
                            width="2rem"
                            class="sapUiTinyMarginEnd"
                        />
                        <Input
                            value="{ckt>/new/text}"
                            width="8rem"
                        />
                        <Button
                            icon="sap-icon://add"
                            press="onNewCheckInType"
                            type="Transparent"
                        />
                        <Button
                            icon="sap-icon://edit"
                            press="onEditCheckInTypes"
                            type="Transparent"
                            visible="{=!${view>/ui/checkInTypesEditable}}"
                        />
                        <Button
                            icon="sap-icon://save"
                            press="onEditCheckInTypes"
                            type="Transparent"
                            visible="{view>/ui/checkInTypesEditable}"
                        />
                    </HBox>
                    <ToolbarSpacer />
                    <Button
                        icon="sap-icon://database"
                        press="onStoreAllData"
                    />
                    <Button
                        icon="sap-icon://full-screen"
                        press="onOpenMessage"
                        visible="{= !${view>/ui/cmdPanelExpanded}}"
                    />
                    <HBox visible="{view>/ui/cmdPanelExpanded}">
                        <Button
                            icon="sap-icon://copy"
                            press="onCopyMessage"
                        />
                        <Button
                            text="Export"
                            press="onExportAllData"
                        />
                        <Button
                            text="Import"
                            press="onImportAllData"
                        />
                        <Button
                            icon="sap-icon://clear-all"
                            press="onClearAllData"
                        />
                        <Button
                            text="Push"
                            press="onPushAllData"
                            enabled="{view>/settings/use_remote_odata}"
                        />
                        <Button
                            text="Pull"
                            press="onPullAllData"
                            enabled="{view>/settings/use_remote_odata}"
                        />
                    </HBox>
                </OverflowToolbar>
            </headerToolbar>
            <content>
                <TextArea
                    id="msgTextArea"
                    value="{view>/message}"
                    width="100%"
                    height="12rem"
                />
            </content>
        </Panel>
        <HBox
            alignItems="Center"
            visible="{view>/ui/cmdPanelExpanded}"
        >
            <Label
                text="打卡类型"
                showColon="true"
                labelFor="checkInTypeInput"
                width="4rem"
                class="sapUiSmallMarginBegin sapUiTinyMarginEnd"
            />
            <Input
                value="{ckt>/new/text}"
                width="8rem"
            />
            <Button
                icon="sap-icon://add"
                press="onNewCheckInType"
                type="Transparent"
            />
            <Button
                icon="sap-icon://edit"
                press="onEditCheckInTypes"
                type="Transparent"
                visible="{=!${view>/ui/checkInTypesEditable}}"
            />
            <Button
                icon="sap-icon://save"
                press="onEditCheckInTypes"
                type="Transparent"
                visible="{view>/ui/checkInTypesEditable}"
            />
        </HBox>
        <List
            id="typesList"
            items="{ckt>/types}"
            visible="{view>/ui/checkInTypesEditable}"
            mode="Delete"
            headerText="({view>/typesCount})"
            delete="onDeleteCheckInType"
            updateFinished=".onTypesUpdateFinished"
        >
            <StandardListItem
                title="{ckt>text}"
                type="Detail"
                detailPress="onUpdateCheckInType"
            />
        </List>

        <VBox visible="{=!${view>/ui/checkInTypesEditable}}" />
        <footer>
            <Bar />
        </footer>
    </Page>
</mvc:View>
