<mvc:View
    controllerName="ct.trec.recordscreate.controller.OfflineCreate"
    xmlns:core="sap.ui.core"
    xmlns:mvc="sap.ui.core.mvc"
    displayBlock="true"
    xmlns="sap.m"
>
    <Page title="{i18n>title}">
        <headerContent>
            <OverflowToolbar>
                <ToolbarSpacer />
                <ObjectStatus
                    text="场景"
                    state="Success"
                />
                <Select items="{csc>/scenarios}">
                    <core:Item
                        key="{csc>text}"
                        text="{csc>text}"
                    />
                </Select>
                <Button
                    text="Scenarios"
                    press="onScenarios"
                />
                <Button
                    text="Import"
                    press="onImportDataFromJson"
                />
                <Button
                    text="ID {view>/deviceId}"
                    press="onGetDeviceId"
                />
                <Button
                    text="Push"
                    press="onPushAllDataToUserDataStore"
                />
                <Button
                    text="Pull"
                    press="onPullAllDataFromUserDataStore"
                />
                <Button
                    text="Remove"
                    press="onRemoveUserDataStore"
                />
            </OverflowToolbar>
        </headerContent>
        <VBox visible="{=!${view>/ui/checkInTypesEditable}}">
            <Table
                id="itemsList"
                autoPopinMode="true"
                mode="Delete"
                delete="onDeleteCheckInItem"
                updateFinished="onItemsUpdateFinished"
                growing="true"
                growingThreshold="20"
                items="{ 
                        path: 'tci>/items',
                        sorter: {
                            path: 'timestamp',
                            descending: true,
                            group: '.getItemsByDateGroup'
                        },
                        groupHeaderFactory: '.getItemsGroupByDateHeader'
                    }"
            >
                <headerToolbar>
                    <Toolbar>
                        <Label text="记录 ({view>/itemsCount})" />
                    </Toolbar>
                </headerToolbar>
                <infoToolbar>
                    <OverflowToolbar content="{ckt>/types}">
                        <Button
                            text="{ckt>text}"
                            press="onTypedCheckIn"
                        />
                    </OverflowToolbar>
                </infoToolbar>
                <columns>
                    <Column width="8rem">
                        <Text text="动作" />
                    </Column>
                    <Column
                        width="4rem"
                        popinDisplay="WithoutHeader"
                    >
                        <Text text="时间" />
                    </Column>
                </columns>
                <items>
                    <ColumnListItem
                        vAlign="Middle"
                        type="Inactive"
                    >
                        <cells>
                            <ObjectIdentifier
                                title="{tci>value}"
                                titleActive="true"
                                titlePress="onCheckInItemPress"
                                text="{
                                        path:'tci>comment',
                                        formatter : '.formatEmptyText'
                                    }"
                            />
                            <TimePicker
                                value="{
                                        path:'tci>timestamp',
                                        type:'sap.ui.model.type.Time',
                                        formatOptions: {
                                            'pattern': 'HH:mm'
                                        }
                                    }"
                            />
                        </cells>
                    </ColumnListItem>
                </items>
            </Table>
        </VBox>
        <footer>
            <Bar />
        </footer>
    </Page>
</mvc:View>
